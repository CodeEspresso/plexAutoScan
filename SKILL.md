# 安全修复技能 - 专门用于Bug修复
## 描述
严格遵循最小修改原则，修复前分析、修复后验证，绝不引入新问题。
## 触发条件
当用户提及以下关键词时激活：
- "修复bug"、"解决这个问题"、"帮我改一下"
- 用户粘贴错误日志或描述异常行为
## 执行步骤
### 步骤1：问题理解（必须执行）
- 要求用户提供：错误现象、错误日志、相关文件
- 分析可能原因，列出2-3个嫌疑点
- 输出分析报告，请求确认方向
### 步骤2：影响分析（必须执行）
- 读取相关文件的全部内容
- 分析函数调用关系
- 列出受影响的所有文件（最多5个）
- 标注风险等级（🔴高风险/🟡中风险/🟢低风险）
### 步骤3：分支验证（必须执行）
- 执行 `git branch --show-current`
- 如在main/master分支，输出警告并停止
- 提醒用户创建fix分支
### 步骤4：修改计划（必须输出）
- 列出要修改的文件和具体行号
- 说明每个修改的预期效果
- 请求用户批准
### 步骤5：执行修改（按计划）
- 每修改一个文件，添加 `// [FIX]` 注释
- 修改完成后，用diff格式展示变更
- 等待用户确认后再继续
### 步骤6：验证测试（必须执行）
- 自动发现测试命令（从package.json）
- 运行相关测试
- 输出测试结果摘要
### 步骤7：交付报告（必须输出）
- 变更摘要（文件数、行数）
- 验证报告（分支、文件、标记、测试）
- 提交信息建议